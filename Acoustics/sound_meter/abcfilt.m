%FORMAT   : y = ABCFILT(x,abc,fs)
%FUNCTION : Performs a A, B or C weighting of a time sequence
%
%INPUT    : x is a vector with a sampled time sequence (fs = 48 kHz)
%           abc is one of three strings 'a', 'b' or 'c', selecting the type of weighting to be used
%OUTPUT   : y is a vector of size(x)

%DATE     : 15.12.94
%AUTHOR   : Clemen Boje Jensen
%REF.     :

function y = abcfilt(x,abc)

if 1,
	if abc == 'a',
		B = [5.9628076384555616e-001 -2.1979441609825652e+000  2.6197741240252716e+000 -4.5000120214193976e-001 -1.2967689565471458e+000  8.2792822614118720e-001 -3.8804785142064528e-002 -7.2374999279271872e-002  1.1910990080972492e-002];
		A = [1.0000000000000000e+000 -4.2759364099411440e+000  6.8881761293928544e+000 -4.5823723098771088e+000 -2.2151304772410896e-004  1.7761355871044310e+000 -1.0304302533654768e+000  2.4770310841625652e-001 -2.3054334263318424e-002];
	elseif abc == 'b',
  		B = [5.0489802639837400e-001 -1.3562012011818778e+000  8.6208063018118848e-001  4.8104415774316480e-001 -6.1698906176367328e-001  8.4055400382457536e-002  5.1197624950151248e-002 -1.0085576709785116e-002];
		A = [1.0000000000000000e+000 -3.3615419460627152e+000  3.8148687570741456e+000 -1.0951921860939708e+000 -1.0009657855651164e+000  8.6102465426447040e-001 -2.4341928333131712e-001  2.5225860059141828e-002];
	elseif abc == 'c',
		B = [5.0386374547526944e-001 -8.4955928475537728e-001  1.0755377837594138e-002  4.9081411918079072e-001 -1.2491104376969380e-001 -4.1027830428092080e-002  1.0064916459508742e-002];
		A = [1.0000000000000000e+000 -2.3820765259061904e+000  1.4817071717824434e+000  3.5608875146485664e-001 -6.5218916699857824e-001  2.2222791778867404e-001 -2.5754722463923816e-002];
	end
	y = filter(B,A,x);
else
	fs = 48000;
	if abc == 'a',
		Zs = [0 0 0 0];
		Ps = -2*pi*[20.6 20.6 107.7 737.9];
	elseif abc == 'b',
		Zs = [0 0 0];
		Ps = -2*pi*[20.6 20.6 158.5];
	elseif abc == 'c',
		Zs = [0 0];
		Ps = -2*pi*[20.6 20.6];
	end
	[Zz,Pz,G] = bilinear(Zs',Ps',1,fs);
	LPamp = abs(freqs(1,poly(-2*[12200 12200]/fs),linspace(0,1,128)));
	[Blp,Alp]=yulewalk(4,linspace(0,1,128),LPamp);
	B = real(poly([Zz;roots(Blp)]));
	A = real(poly([Pz;roots(Alp)]));
	G = abs(freqz(B,A,[0 1000]*2*pi/fs));
	B = B/G(2);
	%eval(['save ',abc,'filt B A -ascii -double'])
	y = filter(B,A,x);
end